# -*- coding: utf-8 -*-
"""Basic 6 - Hypergraph Arithmetic.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/github/pnnl/HyperNetX/blob/master/tutorials/basic/Basic%206%20-%20Hypergraph%20Arithmetic.ipynb
"""

# !pip install hypernetx ## uncomment to run in Colab

#importing and installing packages
import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec
import hypernetx as hnx
import warnings
warnings.simplefilter('ignore')
warnings.filterwarnings("ignore", category=DeprecationWarning)
#set plotting parameters
TextSize = 15

"""# Operations on Hypergraphs

Here we demonstrate some basic hypergraph arithmetic including addition, subtraction, union, and intersection.
"""

#plotting parameters to color edges for comparing and position layout
colors = plt.rcParams['axes.prop_cycle'].by_key()['color'][:4]
edge_color_dict = {'M1':colors[0], 'M2': colors[1], 'M3':colors[2], 'M4':colors[3]}

HG_pos = {
         'P1': (0.0, 0.5),
         'P2': (0.0, 0.0),
         'P3': (0.5, 0.0),
         'P4': (1.0, 0.0),
         'P5': (1.0, 0.5),
         'P6': (0.5, 0.5)}

#we start by defining our two hypergraphs for comparing

HG1 = {'M1': {'P4', 'P5'},
       'M2': {'P5', 'P6'},
       'M4': {'P1', 'P2'}}
H1 = hnx.Hypergraph(HG1)


HG2 = {'M1': {'P4', 'P5'},
       'M3': {'P2', 'P3', 'P4'},
       'M4': {'P1', 'P2', 'P3'}}
H2 = hnx.Hypergraph(HG2)

#visualize our two hypergraphs
plt.figure(figsize = (8,3))
gs = gridspec.GridSpec(1, 2)

ax = plt.subplot(gs[0, 0]) #plot time series
plt.title('$HG_1$')
hnx.draw(H1, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 1]) #plot time series
plt.title('$HG_2$')
hnx.draw(H2, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

plt.subplots_adjust(wspace=0.5)
plt.show()

"""## Addition"""

plt.figure(figsize = (12,3))
gs = gridspec.GridSpec(1, 3)

ax = plt.subplot(gs[0, 0]) #plot time series
plt.title('$HG_1$')
hnx.draw(H1, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 1]) #plot time series
plt.title('$HG_2$')
hnx.draw(H2, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 2]) #plot time series
plt.title('$HG_1 + HG_2$')
hnx.draw(H1+H2, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

plt.subplots_adjust(wspace=0.5)
plt.show()

"""# Subtraction"""

plt.figure(figsize = (12,3))
gs = gridspec.GridSpec(1, 3)

ax = plt.subplot(gs[0, 0]) #plot time series
plt.title('$HG_1$')
hnx.draw(H1, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 1]) #plot time series
plt.title('$HG_2$')
hnx.draw(H2, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 2]) #plot time series
plt.title('$HG_1 - HG_2$')
hnx.draw(H1-H2, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

plt.subplots_adjust(wspace=0.5)
plt.show()

plt.figure(figsize = (12,3))
gs = gridspec.GridSpec(1, 3)

ax = plt.subplot(gs[0, 0]) #plot time series
plt.title('$HG_1$')
hnx.draw(H1, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 1]) #plot time series
plt.title('$HG_2$')
hnx.draw(H2, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 2]) #plot time series
plt.title('$HG_2 - HG_1$')
hnx.draw(H2-H1, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

plt.subplots_adjust(wspace=0.5)
plt.show()

"""## Union"""

plt.figure(figsize = (12,3))
gs = gridspec.GridSpec(1, 3)

ax = plt.subplot(gs[0, 0]) #plot time series
plt.title('$HG_1$')
hnx.draw(H1, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 1]) #plot time series
plt.title('$HG_2$')
hnx.draw(H2, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 2]) #plot time series
plt.title('$HG_1 \\cup HG_2$')
hnx.draw(H1.union(H2), pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

plt.subplots_adjust(wspace=0.5)
plt.show()

"""# Intersection"""

plt.figure(figsize = (12,3))
gs = gridspec.GridSpec(1, 3)

ax = plt.subplot(gs[0, 0]) #plot time series
plt.title('$HG_1$')
hnx.draw(H1, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 1]) #plot time series
plt.title('$HG_2$')
hnx.draw(H2, pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

ax = plt.subplot(gs[0, 2]) #plot time series
plt.title('$HG_1 \\cap HG_2$')
hnx.draw(H1.intersection(H2), pos = HG_pos, edges_kwargs = {'edgecolors': edge_color_dict})

plt.subplots_adjust(wspace=0.5)
plt.show()



